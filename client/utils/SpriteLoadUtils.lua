--- @class StarsAtlas
StarsAtlas = {
    folder = "Stars",
    star16 = "star_hero_1_6",
    star13 = "star_hero_13",
    star712 = "star_hero_7_12",
    starTavern1 = "icon_star_yellow_tavern",
    starTavern6 = "icon_star_orange_tavern",
    starTavern7 = "icon_star_red_tavern",
    starInfo16 = "sao_vang_hero_info",
    starInfo712 = "sao_tim_hero_info",
    starInfo13 = "sao_do_hero_info",
    starEvolve16 = "sao_vang_evolve",
    starEvolve712 = "sao_tim_evolve",
    starEvolve13 = "sao_do_evolve",
}

ResourceLoadUtils.iconFirstPurchase = "IconFirstPurchase"
ResourceLoadUtils.iconRawPack = "IconRawPack"
ResourceLoadUtils.iconLimitedPack = "IconLimitedPack"
ResourceLoadUtils.iconLimitedPackHalloween = "IconLimitedPackHalloween"
ResourceLoadUtils.iconLimitedPackXmas = "IconLimitedPackXmas"
ResourceLoadUtils.iconLimitedPackNewYear = "IconLimitedPackNewYear"
ResourceLoadUtils.iconLimitedPackEliteBundle = "IconLimitedPackEliteBundle"
ResourceLoadUtils.iconLimitedPackValentineBundle = "IconLimitedPackValentineBundle"
ResourceLoadUtils.iconCoins = "IconCoins"
ResourceLoadUtils.iconBgIapShop = "IconBgIapShop"
ResourceLoadUtils.iconChapterLunarBoss = "IconChapterLunarBoss"
ResourceLoadUtils.iconCurrencies = "IconCurrencies"
ResourceLoadUtils.iconQuickBattleTicket = "IconQuickBattle"
ResourceLoadUtils.iconFactions = "IconFactions"
ResourceLoadUtils.iconRarity = "IconRarity"
ResourceLoadUtils.iconFactionsFilter = "IconFactionsFilter"
ResourceLoadUtils.iconArtifacts = "IconArtifacts"
ResourceLoadUtils.artifactFragments = "IconArtifactFragments"
ResourceLoadUtils.heroFragmentByStars = "IconHeroFragments"
ResourceLoadUtils.heroFragmentCurrencies = "IconHeroFragmentCurrencies"
ResourceLoadUtils.iconAvatar = "IconAvatar"
ResourceLoadUtils.iconBorder = "IconBorder"
ResourceLoadUtils.iconEquipments = "IconEquipments"
ResourceLoadUtils.iconTalent = "IconTalent"
ResourceLoadUtils.iconEquipmentEffect = "IconEquipmentEffect"
ResourceLoadUtils.iconCurrenciesEffect = "IconCurrenciesEffect"
ResourceLoadUtils.iconArtifactEffect = "IconArtifactEffect"
ResourceLoadUtils.iconBuffDebuffs = "IconBuffDebuffs"
ResourceLoadUtils.equipmentRandom = "IconEquipmentRandom"
ResourceLoadUtils.iconStarNumbers = "IconStarNumbers"
ResourceLoadUtils.iconClassHeroes = "IconClassHeroes"
ResourceLoadUtils.iconRaidLevel = "IconRaidLevel"
ResourceLoadUtils.iconVip = "IconVips"
ResourceLoadUtils.levelNumber = "LevelNumber"
ResourceLoadUtils.iconFeature = "IconFeature"
ResourceLoadUtils.iconLands = "IconLands"
ResourceLoadUtils.defenseModeLands = "DefenseModeLands"
ResourceLoadUtils.formationNumber = "FormationNumber"
ResourceLoadUtils.iconQuestTree = "IconQuestTree"
ResourceLoadUtils.iconGuildLogo = "IconGuildLogo"
ResourceLoadUtils.iconLinking = "IconLinking"
ResourceLoadUtils.iconHeroLinking = "IconHeroLinking"
ResourceLoadUtils.iconTopRanking = "IconTopRanking"
ResourceLoadUtils.iconClassSummoner = "IconClassSummoner"
ResourceLoadUtils.bgSkillMasteries = "BgSkillMasteries"
ResourceLoadUtils.iconCompanionBuff = "IconCompanions"
ResourceLoadUtils.iconStones = "IconStones"
ResourceLoadUtils.iconHeroCards = "IconHeroCards"
ResourceLoadUtils.iconSkillMasteries = "IconSkillMasteries"
ResourceLoadUtils.iconSkillMasteriesPreview = "IconSkillMasteriesPreview"
ResourceLoadUtils.iconArenaRank = "IconRank"
ResourceLoadUtils.floorSprite = "FloorSprite"
ResourceLoadUtils.iconEventTime = "IconEventTime"
ResourceLoadUtils.iconEventMidAutumn = "IconEventMidAutumn"
ResourceLoadUtils.iconEventHalloween = "IconEventHalloween"
ResourceLoadUtils.iconEventXmas = "IconEventXmas"
ResourceLoadUtils.iconEventNewYear = "IconEventNewYear"
ResourceLoadUtils.iconEventLunarNewYear = "IconEventLunarNewYear"
ResourceLoadUtils.iconEventBlackFriday = "IconEventBlackFriday"
ResourceLoadUtils.bannerEventTime = "BannerEventTime"
ResourceLoadUtils.iconBattleSummoner = "IconBattleSummoner"
ResourceLoadUtils.iconBannerSummoner = "IconBannerSummoner"
ResourceLoadUtils.iconBannerSummoner2 = "IconBannerSummoner2"
ResourceLoadUtils.iconBannerRaid = "IconBannerRaid"
ResourceLoadUtils.iconBattleEffect = "BattleEffect"
ResourceLoadUtils.iconRollDices = "IconRollDices"
ResourceLoadUtils.bgWorldMap = "BgWorldMap"
ResourceLoadUtils.iconChest = "IconChest"
ResourceLoadUtils.iconDungeon = "IconDungeon"
ResourceLoadUtils.guildWarTower = "GuildWarTower"
ResourceLoadUtils.rateUpSummon = "RateUpSummon"
ResourceLoadUtils.rateUpSummonBanner = "RateUpSummonBanner"
ResourceLoadUtils.iconSkin = "IconSkin"
ResourceLoadUtils.raritySkin = "SkinRarity"
ResourceLoadUtils.frameItem = "IconFrameItem"
ResourceLoadUtils.iconExchangeBase = "IconExchangeBase"
ResourceLoadUtils.iconSkills = "IconSkills"
ResourceLoadUtils.iconSkillMainCharacters = "IconSkillMainCharacters"
ResourceLoadUtils.iconEventBundlePack = "IconEventBundlePack"
ResourceLoadUtils.defenseModeTower = "DefenseModeTower"
ResourceLoadUtils.iconHeroCardBorder = "IconHeroCardBorder"
ResourceLoadUtils.iconEventLunarPath = "IconEventLunarPath"
ResourceLoadUtils.iconLunarRollDices = "IconLunarRollDices"
ResourceLoadUtils.iconEventValentine = "IconEventValentine"
ResourceLoadUtils.iconHeroFoodNoBorder = "IconHeroFoodNoBorder"
ResourceLoadUtils.iconEventNewHeroBundle = "IconEventNewHeroBundle"
ResourceLoadUtils.iconEventMergeServer = "IconEventMergeServer"
ResourceLoadUtils.iconBannerEventNewHeroDailyQuest = "BannerEventNewHeroDailyQuest"
ResourceLoadUtils.iconBannerEventNewHeroCollectionQuest = "BannerEventNewHeroCollectionQuest"
ResourceLoadUtils.iconEventEasterEgg = "IconEventEasterEgg"
ResourceLoadUtils.iconLimitedPackEasterEgg = "IconLimitedPackEasterEgg"
ResourceLoadUtils.iconWelcomeBack = "IconWelcomeBack"
ResourceLoadUtils.iconWelcomeBackBundle = "IconWelcomeBackBundle"
ResourceLoadUtils.iconEventBirthday = "IconEventBirthday"
ResourceLoadUtils.iconLimitedPackBirthday = "IconLimitedPackBirthday"
ResourceLoadUtils.iconClassFormation = "IconClassFormation"

require "lua.client.core.main.LRUCache"
local atlasLRUCache = LRUCache(14)

local folderAtlasDict = {}

local constantAtlasDict = {}

local normalAtlasList = {
    ResourceLoadUtils.floorSprite,
    ResourceLoadUtils.guildWarTower,
    ResourceLoadUtils.iconBannerSummoner,
    ResourceLoadUtils.iconBuffDebuffs,
    ResourceLoadUtils.iconBorder,
    ResourceLoadUtils.iconBattleSummoner,
    ResourceLoadUtils.iconAvatar,
    ResourceLoadUtils.iconCompanionBuff,
    ResourceLoadUtils.iconDungeon,
    ResourceLoadUtils.equipmentRandom,
    ResourceLoadUtils.iconEquipments,
    ResourceLoadUtils.iconGuildLogo,
    ResourceLoadUtils.heroFragmentByStars,
    ResourceLoadUtils.iconLimitedPack,
    ResourceLoadUtils.iconQuestTree,
    ResourceLoadUtils.iconQuickBattleTicket,
    ResourceLoadUtils.iconRaidLevel,
    ResourceLoadUtils.iconArenaRank,
    ResourceLoadUtils.iconRawPack,
    ResourceLoadUtils.iconStones,
    ResourceLoadUtils.iconVip,
    ResourceLoadUtils.levelNumber
}

--- @param atlasName string
local IsNormalAtlas = function(atlasName)
    for _, v in ipairs(normalAtlasList) do
        if atlasName == v then
            return true
        end
    end
    return false
end

--- @return UnityEngine_U2D_SpriteAtlas
--- @param atlasName string
local LoadAtlas = function(atlasName)
    local assetPath = string.format("Textures/%s", atlasName)
    return ResourceLoadUtils.LoadObject(assetPath, ComponentName.UnityEngine_U2D_SpriteAtlas)
end

--- @return UnityEngine_U2D_SpriteAtlas
--- @param atlasName string
--- @param unloadAllLoadedObjects boolean
local function UnloadAtlas(atlasName, unloadAllLoadedObjects)
    local assetPath = string.format("Textures/%s", atlasName)
    --XDebug.Log("Unload atlas: " .. assetPath)
    ResourceLoadUtils.UnloadObject(assetPath, ComponentName.UnityEngine_U2D_SpriteAtlas, unloadAllLoadedObjects)
end

--- @return UnityEngine_U2D_SpriteAtlas
--- @param atlasName string
local LoadNormalAtlas = function(atlasName)
    --print(string.format("Load normal: %s", atlasName))
    --- @type UnityEngine_U2D_SpriteAtlas
    local atlas = atlasLRUCache:GetValue(atlasName)
    if atlas == nil then
        atlas = LoadAtlas(atlasName)
    end
    local removedAtlas = atlasLRUCache:Refer(atlas)
    if removedAtlas ~= nil then
        UnloadAtlas(removedAtlas.name)
    end
    return atlas
end

--- @return UnityEngine_U2D_SpriteAtlas
--- @param atlasName string
local LoadFolderAtlas = function(atlasType, atlasName)
    --print(string.format("Load folder: %s, %s", tostring(atlasType), atlasName))
    local atlasFolder = folderAtlasDict[atlasType]
    if atlasFolder == nil then
        atlasFolder = { }
        folderAtlasDict[atlasType] = atlasFolder
    end
    local atlas = atlasFolder[atlasName]
    if atlas == nil then
        atlas = LoadAtlas(atlasName)
        atlasFolder[atlasName] = atlas
    end
    return atlas
end

--- @param atlasName string
local LoadInstantAtlas = function(atlasName)
    --print(string.format("Load instant: %s", atlasName))
    local atlas = constantAtlasDict[atlasName]
    if atlas == nil then
        atlas = LoadAtlas(atlasName)
        constantAtlasDict[atlasName] = atlas
        UnloadAtlas(atlasName, false)
    end
    return atlas
end

function ResourceLoadUtils.UnloadFolderAtlas()
    for folderName, atlasFolder in pairs(folderAtlasDict) do
        if atlasFolder then
            for _, atlas in pairs(atlasFolder) do
                UnloadAtlas(string.format("%s/%s", folderName, atlas.name))
            end
        end
    end
    folderAtlasDict = {}
end

--- @return UnityEngine_Texture
--- @param type MoneyType
function ResourceLoadUtils.LoadMoneyIcon(type)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconCoins, type)
end

--- @return UnityEngine_Texture
--- @param heroFoodType HeroFoodType
function ResourceLoadUtils.LoadHeroFoodNoBorderIcon(heroFoodType)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconHeroFoodNoBorder, heroFoodType)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadChestIcon(tier)
    return ResourceLoadUtils.LoadTexture(ResourceLoadUtils.iconChest, tier, ComponentName.UnityEngine_Sprite)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadFactionIcon(faction)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconFactions, faction)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadCLassIcon(class)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconClassHeroes, class)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadSkinIcon(skinId)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconSkin, skinId)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadSkinRarity(rarity)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.raritySkin, rarity)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadGuildIcon(iconId)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconGuildLogo, iconId)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadTopRankingIcon(rank)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconTopRanking, rank)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadCompanionBuffOnIcon(buff)
    local name = string.format("companion_buff_%d", buff)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconCompanionBuff, name)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadCompanionBuffOffIcon(buff)
    local name = string.format("companion_buff_%d_off", buff)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconCompanionBuff, name)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadStarsIcon(name)
    return ResourceLoadUtils.LoadSpriteFromAtlas(StarsAtlas.folder, name)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadStonesIcon(rarity, id)
    local name = string.format("stone_%s_%s", rarity, id)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconStones, name)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadSkillIcon(heroId, skillId)
    local atlasName = string.format("%s/IconSkills_%d", ResourceLoadUtils.iconSkills, heroId)
    local spriteName = string.format("icon_skill_%d_%d", heroId, skillId)
    return ResourceLoadUtils.LoadSpriteFromAtlas(atlasName, spriteName, ResourceLoadUtils.iconSkills)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadSkillMainIcon(class, tier, skillId)
    local atlasName = string.format("%s/IconSkillSummoner_%s_%s", ResourceLoadUtils.iconSkillMainCharacters, class, tier)
    local spriteName = string.format("icon_skill_main_character_%s_%s_%s", class, tier, skillId)
    return ResourceLoadUtils.LoadSpriteFromAtlas(atlasName, spriteName, ResourceLoadUtils.iconSkillMainCharacters)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadHeroCardsIcon(heroId, heroStar)
    local skinLevel = ClientConfigUtils.GetSkinLevelByStar(heroId, heroStar)
    return ResourceLoadUtils.LoadHeroCardsIconSkinLevel(heroId, skinLevel)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadHeroCardsIconSkinLevel(heroId, skinLevel)
    local spriteName
    if heroId >= 10000 then
        local heroTier = ResourceMgr.GetHeroesConfig():GetHeroTier():GetHeroTier(heroId)
        if heroTier ~= nil and heroTier <= 5 then
            skinLevel = math.min(skinLevel, 2)
        end
    end
    spriteName = string.format("hero_icon_%s_%s", heroId, skinLevel)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconHeroCards, spriteName)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadHeroesFoodIcon(type)
    local id = type
    if type ~= HeroFoodType.MOON and type ~= HeroFoodType.SUN then
        id = ClientConfigUtils.GetFoodMoonSunByFaction(ClientConfigUtils.GetFactionHeroFoodType(type))
    end
    local spriteName = string.format("hero_food_%s", id)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconHeroCards, spriteName)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadSkillMasteryIcon(class, id)
    local spriteName = string.format("icon_mastery_%s_%s", class, id)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconSkillMasteries, spriteName)
end
function ResourceLoadUtils.LoadSkillMasteryIconPreview(class, id)
    local spriteName = string.format("icon_mastery_%s_%s", class, id)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconSkillMasteriesPreview, spriteName)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadArenaRankIcon(rank)
    local spriteName = string.format("rank_%d", rank)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconArenaRank, spriteName)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadArenaRank12Icon(rank)
    local spriteName = string.format("rank_top_%d", rank)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconArenaRank, spriteName)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadEventTimeIcon(type)
    local spriteName = string.format("icon_event_time_%s", type)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconEventTime, spriteName)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadEventMidAutumn(midAutumnTab)
    local spriteName = string.format("icon_mid_autumn_%s", midAutumnTab)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconEventMidAutumn, spriteName)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadEventHalloween(halloweenTab)
    local spriteName = string.format("icon_halloween_%s", halloweenTab)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconEventHalloween, spriteName)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadEventXmas(halloweenTab)
    local spriteName = string.format("%s", halloweenTab)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconEventXmas, spriteName)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadEventNewYear(halloweenTab)
    local spriteName = string.format("%s", halloweenTab)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconEventNewYear, spriteName)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadEventLunarNewYear(halloweenTab)
    local spriteName = string.format("%s", halloweenTab)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconEventLunarNewYear, spriteName)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadEventMergeServerIcon(mergeServerTab)
    local spriteName = string.format("%s", mergeServerTab)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconEventMergeServer, spriteName)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadEventBirthdayIcon(eventBirthdayTab)
    local spriteName = string.format("%s", eventBirthdayTab)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconEventBirthday, spriteName)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadEventValentine(valentineTab)
    local spriteName = string.format("%s", valentineTab)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconEventValentine, spriteName)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadEventLunarPathIcon(lunarPathTab)
    local spriteName = string.format("%s", lunarPathTab)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconEventLunarPath, spriteName)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadEventBlackFriday(blackFridayTab)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconEventBlackFriday, blackFridayTab)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadBattleSummonerIcon(id, star)
    local spriteName = string.format("summoner_%d_%d", id, star)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconBattleSummoner, spriteName)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadBannerSummonerIcon(id, tier)
    local spriteName = string.format("summoner_%d_%d", id, tier)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconBannerSummoner, spriteName)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadBannerRaid(id)
    local spriteName = string.format("%d", id)
    return ResourceLoadUtils.LoadTexture(ResourceLoadUtils.iconBannerRaid, spriteName, ComponentName.UnityEngine_Sprite)
end

function ResourceLoadUtils.LoadBannerEventNewHeroDailyQuest(dataId)
    local spriteName = string.format("banner_new_hero_daily_quest_%d", dataId)
    return ResourceLoadUtils.LoadTexture(ResourceLoadUtils.iconBannerEventNewHeroDailyQuest, spriteName, ComponentName.UnityEngine_Sprite)
end

function ResourceLoadUtils.LoadBannerEventNewHeroCollectionQuest(dataId)
    local spriteName = string.format("banner_new_hero_collection_quest_%d", dataId)
    return ResourceLoadUtils.LoadTexture(ResourceLoadUtils.iconBannerEventNewHeroCollectionQuest, spriteName, ComponentName.UnityEngine_Sprite)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadEventEasterEggIcon(easterEggTab)
    local spriteName = string.format("%s", easterEggTab)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconEventEasterEgg, spriteName)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadWelcomeBackIcon(welcomeBackTab)
    local spriteName = string.format("%s", welcomeBackTab)
    return ResourceLoadUtils.LoadSpriteFromAtlas(ResourceLoadUtils.iconWelcomeBack, spriteName)
end

--- Just use to load sprite from atlas
--- @return UnityEngine_Sprite
--- @param atlasName string
--- @param assetName string
function ResourceLoadUtils.LoadSpriteFromAtlas(atlasName, assetName)
    assetName = tostring(assetName)
    local atlas

    if atlasName == ResourceLoadUtils.iconSkills or atlasName == ResourceLoadUtils.iconSkillMainCharacters then
        atlas = LoadFolderAtlas(atlasName, atlasName)
    elseif IsNormalAtlas(atlasName) then
        atlas = LoadNormalAtlas(atlasName)
    else
        atlas = LoadInstantAtlas(atlasName)
    end
    local sprite = atlas:GetSprite(assetName)
    if sprite == nil then
        XDebug.Log(string.format("Missing: %s/%s", atlasName, assetName))
    end
    return sprite
end

--- @return UnityEngine_U2D_SpriteAtlas
--- @param atlasName string
function ResourceLoadUtils.PreloadAtlas(atlasName)
    LoadNormalAtlas(atlasName)
end

--- @return UnityEngine_Texture
--- @param folder string
--- @param folder string
--- @param assetName string
function ResourceLoadUtils.LoadTexture(folder, assetName, type)
    local resourceLoadPath = string.format("Textures/%s/%s", folder, assetName)
    return ResourceLoadUtils.LoadObject(resourceLoadPath, type)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadMythicalAvatar(id)
    if id == -1 then
        id = 0
    end
    local spriteName = string.format("mythical_%d", id)
    return ResourceLoadUtils.LoadTexture(ResourceLoadUtils.rateUpSummon, spriteName, ComponentName.UnityEngine_Sprite)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadEventRateUpBanner(id)
    local spriteName = string.format("banner_%d", id)
    return ResourceLoadUtils.LoadTexture(ResourceLoadUtils.rateUpSummonBanner, spriteName, ComponentName.UnityEngine_Sprite)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadIconRollDice(id)
    return ResourceLoadUtils.LoadTexture(ResourceLoadUtils.iconRollDices, tostring(id), ComponentName.UnityEngine_Sprite)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadIconLunarRollDice(id)
    return ResourceLoadUtils.LoadTexture(ResourceLoadUtils.iconLunarRollDices, tostring(id), ComponentName.UnityEngine_Sprite)
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadStarHero(star)
    local sprite
    if star < 7 then
        sprite = ResourceLoadUtils.LoadStarsIcon(StarsAtlas.star16)
    elseif star < 13 then
        sprite = ResourceLoadUtils.LoadStarsIcon(StarsAtlas.star712)
    else
        sprite = ResourceLoadUtils.LoadStarsIcon(StarsAtlas.star13)
    end
    return sprite
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadStarHeroInfo(star)
    local sprite
    if star < 7 then
        sprite = ResourceLoadUtils.LoadStarsIcon(StarsAtlas.starInfo16)
    elseif star < 13 then
        sprite = ResourceLoadUtils.LoadStarsIcon(StarsAtlas.starInfo712)
    else
        sprite = ResourceLoadUtils.LoadStarsIcon(StarsAtlas.starInfo13)
    end
    return sprite
end

--- @return UnityEngine_Sprite
function ResourceLoadUtils.LoadStarHeroEvolve(star)
    local sprite
    if star < 7 then
        sprite = ResourceLoadUtils.LoadStarsIcon(StarsAtlas.starEvolve16)
    elseif star < 13 then
        sprite = ResourceLoadUtils.LoadStarsIcon(StarsAtlas.starEvolve712)
    else
        sprite = ResourceLoadUtils.LoadStarsIcon(StarsAtlas.starEvolve13)
    end
    return sprite
end